{
    "version": "https://jsonfeed.org/version/1",
    "title": "SnowRoll Blog • All posts by \"email\" tag",
    "description": "分享经验，记录生活",
    "home_page_url": "https://snowroll.github.io",
    "items": [
        {
            "id": "https://snowroll.github.io/email/",
            "url": "https://snowroll.github.io/email/",
            "title": "邮件发送脚本",
            "date_published": "2023-07-11T12:00:00.000Z",
            "content_html": "<h1 id=\"背景知识\"><a class=\"markdownIt-Anchor\" href=\"#背景知识\">#</a> 背景知识</h1>\n<ul>\n<li>\n<p>SMTP</p>\n<p>Simple Mail Transfer Protocol（SMTP） ，简单邮件传输协议，其是一种 TCP/IP 协议，用于发送电子邮件。大多数邮箱都是使用 SMTP，例如 Gmail、Outlook、AppleMail、163 等。SMTP 服务器一般使用 25 端口来发送电子邮件。</p>\n<p><strong>发送过程：</strong></p>\n<ul>\n<li>邮件服务器利用 SMTP 将消息从邮件客户端发送到另一个电子邮件服务器</li>\n<li>邮件服务器利用 SMTP 作为中继，转发电子邮件到其接收的电子邮件服务器</li>\n<li>接收邮件服务器使用邮件客户端通过 IMAP 下载传入的邮件，并将其放入收件人邮箱</li>\n</ul>\n</li>\n<li>\n<p>IMAP</p>\n<p>Internet Message Access Protocol（IMAP），交互式网络存储协议，用于管理和检索电子邮件，并在不同设备之间同步。邮件客户端（例如手机端或者网页端邮箱）可以通过这种协议从邮件服务器中获取并下载邮件信息，不同客户端的邮件状态会保持一致。</p>\n<p>可以理解为所有的邮件都保存在邮件服务器中，而 IMAP 作为一个中介，让邮件客户端可以读取服务器中的邮件。这也是邮件附件如果短时间不下载，会被清除的原因。因为电子邮件并未在本地保存。</p>\n</li>\n</ul>\n<h1 id=\"发送脚本\"><a class=\"markdownIt-Anchor\" href=\"#发送脚本\">#</a> 发送脚本</h1>\n<p>一个简单的发邮件脚本，修改一下，可以实现批量脚本发送。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> smtplib</span><br><span class=\"line\"><span class=\"keyword\">from</span> email.mime.multipart <span class=\"keyword\">import</span> MIMEMultipart</span><br><span class=\"line\"><span class=\"keyword\">from</span> email.mime.text <span class=\"keyword\">import</span> MIMEText</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建一个 MIMEMultipart 对象</span></span><br><span class=\"line\">msg = MIMEMultipart()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置邮件的头部信息</span></span><br><span class=\"line\">msg[<span class=\"string\">&#x27;From&#x27;</span>] = <span class=\"string\">&#x27;your_email&#x27;</span></span><br><span class=\"line\">msg[<span class=\"string\">&#x27;To&#x27;</span>] = <span class=\"string\">&#x27;receiver_email&#x27;</span></span><br><span class=\"line\">msg[<span class=\"string\">&#x27;Subject&#x27;</span>] = <span class=\"string\">&#x27;Subject: Test Email&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加正文</span></span><br><span class=\"line\">body = <span class=\"string\">&#x27;This is the body of the email!&#x27;</span></span><br><span class=\"line\">msg.attach(MIMEText(body, <span class=\"string\">&#x27;plain&#x27;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 连接邮件服务器，不同邮件服务器smtp开启方式不一样</span></span><br><span class=\"line\"><span class=\"comment\"># 这里以163邮箱为例，具体开启方法，自行查阅官方文档</span></span><br><span class=\"line\">smtp_server = <span class=\"string\">&#x27;smtp.163.com&#x27;</span></span><br><span class=\"line\">smtp_port = <span class=\"number\">25</span></span><br><span class=\"line\">smtp_username = <span class=\"string\">&#x27;your_email&#x27;</span></span><br><span class=\"line\">smtp_password = <span class=\"string\">&#x27;smtp_token&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">smtp_conn = smtplib.SMTP(smtp_server, smtp_port)</span><br><span class=\"line\">smtp_conn.login(smtp_username, smtp_password)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 发送邮件</span></span><br><span class=\"line\">smtp_conn.sendmail(msg[<span class=\"string\">&#x27;From&#x27;</span>], msg[<span class=\"string\">&#x27;To&#x27;</span>], msg.as_string())</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 关闭连接</span></span><br><span class=\"line\">smtp_conn.quit()</span><br></pre></td></tr></table></figure>\n<ul>\n<li></li>\n</ul>\n",
            "tags": [
                "email"
            ]
        }
    ]
}