{
    "version": "https://jsonfeed.org/version/1",
    "title": "SnowRoll Blog • All posts by \"mongodb\" tag",
    "description": "分享经验，记录生活",
    "home_page_url": "https://snowroll.github.io",
    "items": [
        {
            "id": "https://snowroll.github.io/mongodb/",
            "url": "https://snowroll.github.io/mongodb/",
            "title": "mongodb 常用语句",
            "date_published": "2023-01-29T14:43:00.000Z",
            "content_html": "<p>友情提示： 好用的工具可以节省大量时间，可以直接使用<span class=\"exturl\" data-url=\"aHR0cHM6Ly9uYXZpY2F0LmNvbS9lbi8=\"> navicat</span> 来进行 mongodb 数据库的各种查询操作，简单快捷，不用学习复杂的 API</p>\n<ol>\n<li>\n<p>Mongodb 下载</p>\n<p>官方下载网址： <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubW9uZ29kYi5jb20vdHJ5L2Rvd25sb2FkL2NvbW11bml0eQ==\">https://www.mongodb.com/try/download/community</span></p>\n<p>windows 下的最新版，下载安装后即可连接启动。</p>\n</li>\n<li>\n<p>Mongodb 可视化工具</p>\n<p>简单配置后，即可连接使用</p>\n<img data-src=\"/mongodb/navicat-config.png\" class=\"\">\n</li>\n<li>\n<p>Mongodb 查询语句</p>\n<ul>\n<li>\n<p>简单查询</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 查询语句格式 </span></span><br><span class=\"line\"><span class=\"comment\">// db 数据库 collection 集合 </span></span><br><span class=\"line\"><span class=\"comment\">// query 可选，使用查询操作符指定查询条件</span></span><br><span class=\"line\"><span class=\"comment\">// projection 可选，使用投影操作符返回指定键</span></span><br><span class=\"line\">db.collection.find(query, projection)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 查找集合col中所有元素</span></span><br><span class=\"line\"><span class=\"comment\">// pretty() 格式化显示文档</span></span><br><span class=\"line\">db.col.find().pretty()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 条件语句查询</span></span><br><span class=\"line\"><span class=\"comment\">// 等于</span></span><br><span class=\"line\">db.col.find(&#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;John&quot;</span>&#125;)</span><br><span class=\"line\"><span class=\"comment\">// $lt $lte $gt $gte $ne</span></span><br><span class=\"line\">db.col.find(&#123;<span class=\"string\">&quot;age&quot;</span>: &#123;<span class=\"attr\">$lt</span>: <span class=\"number\">18</span>&#125;&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>组合查询</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// and </span></span><br><span class=\"line\">db.col.find(&#123;<span class=\"attr\">key1</span>:value1, <span class=\"attr\">key2</span>:value2&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// or 用列表把所有条件放在一起</span></span><br><span class=\"line\">db.col.find(&#123;<span class=\"attr\">$or</span>: [&#123;<span class=\"attr\">k1</span>:v1&#125;, &#123;<span class=\"attr\">k2</span>:v2&#125;]&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// and &amp; or</span></span><br><span class=\"line\">db.col.find(&#123;<span class=\"attr\">k1</span>:v1, <span class=\"attr\">$or</span>: [&#123;<span class=\"attr\">k2</span>:v2&#125;, &#123;<span class=\"attr\">k3</span>:v3&#125;]&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li>\n<p>python 库 monoenigine</p>\n<p>将 pymongo 的底层操作进行集成优化，简化 mongodb 的操作</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> mongoengine <span class=\"keyword\">as</span> me</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># connect to MongoDB</span></span><br><span class=\"line\">me.connect(host=<span class=\"string\">&#x27;CONNECTION_STRING&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># venue Schema</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">newVenues</span>(<span class=\"params\">me.Document</span>):</span></span><br><span class=\"line\">    name = me.StringField(required=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    latitude = me.DecimalField(required=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    longitude = me.DecimalField(required=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># some test data</span></span><br><span class=\"line\">venues = [&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;Vega&#x27;</span>,<span class=\"string\">&#x27;latitude&#x27;</span>: <span class=\"number\">55.672867</span>, <span class=\"string\">&#x27;longitude&#x27;</span>: <span class=\"number\">12.473692</span>&#125;,</span><br><span class=\"line\">&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;Tivoli&#x27;</span>,<span class=\"string\">&#x27;latitude&#x27;</span>: <span class=\"number\">55.681256</span>,<span class=\"string\">&#x27;longitude&#x27;</span>: <span class=\"number\">12.553412</span>&#125;]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># the list of venues to bulk insert to MongoDB</span></span><br><span class=\"line\">venues_to_insert_list = []</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> venue <span class=\"keyword\">in</span> venues:</span><br><span class=\"line\">    venues_to_insert_list.append(</span><br><span class=\"line\">        newVenues(name=venue.get(<span class=\"string\">&#x27;name&#x27;</span>),</span><br><span class=\"line\">        latitude=venue.get(<span class=\"string\">&#x27;latitude&#x27;</span>),</span><br><span class=\"line\">        longitude=venue.get(<span class=\"string\">&#x27;longitude&#x27;</span>))</span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># bulk insert to MongoDB</span></span><br><span class=\"line\"><span class=\"comment\"># 无序插入，避免单个错误导致所有插入都失败</span></span><br><span class=\"line\">newVenues.objects.insert(venues_to_insert_list, <span class=\"string\">&quot;ordered&quot;</span>: <span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># single insert</span></span><br><span class=\"line\">venue = newVenues(name=<span class=\"string\">&#x27;Vega&#x27;</span>, latitude=<span class=\"number\">55.672867</span>, logitude=<span class=\"number\">12.473692</span>)</span><br><span class=\"line\">venue.save()</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n",
            "tags": [
                "mongodb"
            ]
        }
    ]
}